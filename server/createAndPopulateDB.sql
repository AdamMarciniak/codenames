
DROP TABLE IF EXISTS words, players, game_words, moves, games;


DO $$
BEGIN
    IF NOT EXISTS (SELECT 1 FROM pg_type WHERE typname = 'team') THEN
        CREATE TYPE team as ENUM ('RED', 'BLUE', 'OBSERVER');
    END IF;
END
$$;

DO $$
BEGIN
    IF NOT EXISTS (SELECT 1 FROM pg_type WHERE typname = 'cardtype') THEN
        CREATE TYPE cardtype as ENUM ('RED', 'BLUE', 'BLACK', 'WHITE');
    END IF;
END
$$;

CREATE TABLE IF NOT EXISTS games (
    id SERIAL PRIMARY KEY,
    created_at TIMESTAMP WITH TIME ZONE NOT NULL,
    game_code VARCHAR(10) NOT NULL UNIQUE
);

CREATE TABLE IF NOT EXISTS players (
    id SERIAL PRIMARY KEY,
    game_code VARCHAR(10) REFERENCES games(game_code) NOT NULL,
    name VARCHAR(40) NOT NULL,
    team team NOT NULL,
    is_cluegiver BOOLEAN DEFAULT FALSE NOT NULL
);


CREATE TABLE IF NOT EXISTS words (
    id SERIAL PRIMARY KEY,
    text VARCHAR(40) NOT NULL UNIQUE
);

CREATE TABLE IF NOT EXISTS game_words (
    id SERIAL PRIMARY KEY,
    word_id SERIAL REFERENCES words(id) NOT NULL,
    game_code VARCHAR(10) REFERENCES games(game_code) NOT NULL,
    sort DECIMAL DEFAULT random(),
    type CARDTYPE NOT NULL
);

CREATE TABLE IF NOT EXISTS moves (
    id SERIAL PRIMARY KEY,
    player_id INTEGER REFERENCES players(id) NOT NULL,
    word_id INTEGER REFERENCES game_words(id),
    is_turn_end BOOLEAN NOT NULL,
    last_updated_at TIMESTAMP WITH TIME ZONE NOT NULL default current_timestamp
);

INSERT INTO games (created_at, game_code) VALUES (current_timestamp, 'TEST');


INSERT INTO words (text) VALUES 
('Hollywood'),
('Screen'),
('Play'),
('Marble'),
('Dinosaur'),
('Cat'),
('Pitch'),
('Bond'),
('Greece'),
('Deck'),
('Spike'),
('Center'),
('Vacuum'),
('Unicorn'),
('Undertaker'),
('Sock'),
('Loch Ness'),
('Horse'),
('Berlin'),
('Platypus'),
('Port'),
('Chest'),
('Box'),
('Compound'),
('Ship'),
('Watch'),
('Space'),
('Flute'),
('Tower'),
('Death'),
('Well'),
('Fair'),
('Tooth'),
('Staff'),
('Bill'),
('Shot'),
('King'),
('Pan'),
('Square'),
('Buffalo'),
('Scientist'),
('Chick'),
('Atlantis'),
('Spy'),
('Mail'),
('Nut'),
('Log'),
('Pirate'),
('Face'),
('Stick'),
('Disease'),
('Yard'),
('Mount'),
('Slug'),
('Dice'),
('Lead'),
('Hook'),
('Carrot'),
('Poison'),
('Stock'),
('Foot'),
('Torch'),
('Arm'),
('Figure'),
('Mine'),
('Suit'),
('Crane'),
('Beijing'),
('Mass'),
('Microscope'),
('Engine'),
('China'),
('Straw'),
('Pants'),
('Europe'),
('Boot'),
('Princess'),
('Link'),
('Luck'),
('Olive'),
('Palm'),
('Teacher'),
('Thumb'),
('Octopus'),
('Hood'),
('Tie'),
('Doctor'),
('Wake'),
('Cricket'),
('Millionaire'),
('Slip'),
('Limousine'),
('Pass'),
('Theater'),
('Plate'),
('Satellite'),
('Ketchup'),
('Hotel'),
('Tail'),
('Tick'),
('Ground'),
('Police'),
('Dwarf'),
('Fan'),
('Dress'),
('Saturn'),
('Grass'),
('Brush'),
('Chair'),
('Rock'),
('Pilot'),
('Telescope'),
('File'),
('Lab'),
('India'),
('Ruler'),
('Nail'),
('Swing'),
('Olympus'),
('Change'),
('Tablet'),
('Australia'),
('Green'),
('Egypt'),
('Line'),
('Lawyer'),
('Witch'),
('Parachute'),
('Crash'),
('Gold'),
('Note'),
('Lion'),
('Plastic'),
('Web'),
('Ambulance'),
('Hospital'),
('Spell'),
('Lock'),
('Water'),
('London'),
('Casino'),
('Cycle'),
('Bar'),
('Cliff'),
('Round'),
('Bomb'),
('Giant'),
('Hand'),
('Ninja'),
('Rose'),
('Drill'),
('Glove'),
('Paste'),
('Fall'),
('Fire'),
('Spider'),
('Spine'),
('Soldier'),
('Horn'),
('Queen'),
('Ham'),
('Litter'),
('Life'),
('Temple'),
('Rabbit'),
('Button'),
('Game'),
('Star'),
('Jupiter'),
('Vet'),
('Night'),
('Air'),
('Battery'),
('Genius'),
('Shop'),
('Bottle'),
('Stadium'),
('Alien'),
('Light'),
('Triangle'),
('Date'),
('Stream'),
('Missile'),
('Scale'),
('Band'),
('Angel'),
('Press'),
('Berry'),
('Card'),
('Check'),
('Draft'),
('Head'),
('Lap'),
('Orange'),
('Ice Cream'),
('Film'),
('Washer'),
('Pool'),
('Shark'),
('Van'),
('String'),
('Calf'),
('Hawk'),
('Eagle'),
('Needle'),
('Forest'),
('Dragon'),
('Key'),
('Belt'),
('Cap'),
('Bell'),
('Leprechaun'),
('Pheonix'),
('Force'),
('Boom'),
('Fork'),
('Alps'),
('Post'),
('Fence'),
('Kangaroo'),
('Mouse'),
('Mug'),
('Horseshoe'),
('Scorpion'),
('Agent'),
('Helicopter'),
('Hole'),
('Organ'),
('Jack'),
('Charge'),
('Lemon'),
('Nurse'),
('Drop'),
('Track'),
('Bank'),
('Germany'),
('Worm'),
('Ray'),
('Capital'),
('Strike'),
('War'),
('Concert'),
('Honey'),
('Canada'),
('Buck'),
('Snowman'),
('Beat'),
('Jam'),
('Copper'),
('Beach'),
('Spring'),
('Match'),
('Diamond'),
('Centaur'),
('March'),
('Roulette'),
('Dog'),
('Cross'),
('Wave'),
('Duck'),
('Wind'),
('Spot'),
('Skyscraper'),
('Paper'),
('Apple'),
('Oil'),
('Cook'),
('Fly'),
('Cast'),
('Bear'),
('Pin'),
('Thief'),
('Trunk'),
('America'),
('Novel'),
('Cell'),
('Bow'),
('Model'),
('Knife'),
('Knight'),
('New York'),
('State'),
('Bermuda'),
('Park'),
('Turkey'),
('Chocolate'),
('Trip'),
('Racket'),
('Bat'),
('Jet'),
('Shakespeare'),
('Bolt'),
('Switch'),
('Wall'),
('Soul'),
('Ghost'),
('Time'),
('Dance'),
('Amazon'),
('Grace'),
('Moscow'),
('Pumpkin'),
('Antarctica'),
('Whip'),
('Heart'),
('Table'),
('Ball'),
('Fighter'),
('Cold'),
('Day'),
('Court'),
('Iron'),
('Whale'),
('Shadow'),
('Contract'),
('Mercury'),
('Conductor'),
('Seal'),
('Car'),
('Ring'),
('Kid'),
('Piano'),
('Laser'),
('Sound'),
('Pole'),
('Superhero'),
('Revolution'),
('Pit'),
('Gas'),
('Glass'),
('Washington'),
('Bark'),
('Snow'),
('Ivory'),
('Pipe'),
('Cover'),
('Degree'),
('Tokyo'),
('Church'),
('Pie'),
('Point'),
('France'),
('Mammoth'),
('Cotton'),
('Robin'),
('Net'),
('Bugle'),
('Maple'),
('England'),
('Field'),
('Robot'),
('Plot'),
('Africa'),
('Tag'),
('Mouth'),
('Kiwi'),
('Mole'),
('School'),
('Sink'),
('Pistol'),
('Opera'),
('Mint'),
('Root'),
('Sub'),
('Crown'),
('Back'),
('Plane'),
('Mexico'),
('Cloak'),
('Circle'),
('Tube'),
('Block'),
('Comic'),
('Fish'),
('Bridge'),
('Moon'),
('Part'),
('Aztec'),
('Smuggler'),
('Train'),
('Embassy'),
('Pupil'),
('Scuba Diver'),
('Ice'),
('Tap'),
('Code'),
('Shoe'),
('Server'),
('Club'),
('Row'),
('Pyramid'),
('Bug'),
('Penguin'),
('Pound'),
('Himalayas'),
('Czech'),
('Rome'),
('Eye'),
('Board'),
('Bed');










